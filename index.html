<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Express â€” Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap" rel="stylesheet">
<style>
  :root{
    --neon:#00ffaa;
    --neon2:#00a8ff;
    --glass: rgba(255,255,255,.06);
    --border: rgba(255,255,255,.08);
    --shadow: 0 18px 50px rgba(0,0,0,.35);
    --maxw: 460px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:'Cairo',system-ui,sans-serif;color:#fff;text-align:center;overflow-x:hidden;
    /* Ø®Ù„ÙÙŠØ© RPG Ù…ØªØ­Ø±ÙƒØ© */
    background:
      radial-gradient(1200px 600px at 10% 10%, #092034 0%, transparent 60%),
      radial-gradient(1000px 500px at 90% 90%, #041821 0%, transparent 60%),
      conic-gradient(from 0deg at 50% 50%, #04131b, #071a25, #0a2a43, #071a25, #04131b);
    background-size: 140% 140%, 140% 140%, 200% 200%;
    animation: bgA 16s ease-in-out infinite, bgB 20s ease-in-out infinite, hue 32s linear infinite;
  }
  @keyframes bgA{0%,100%{background-position:10% 10%, 90% 90%, 0% 50%}50%{background-position:28% 18%, 72% 82%, 100% 50%}}
  @keyframes bgB{0%,100%{filter:saturate(1)}50%{filter:saturate(1.15)}}
  @keyframes hue{0%{filter:hue-rotate(0)}100%{filter:hue-rotate(360deg)}}

  h1{margin:22px auto 10px;font-size:32px;font-weight:900;max-width:var(--maxw)}
  h1 .brand{color:var(--neon)}
  h1 .sub{color:#b8e6ff}
  .wrap{
    width:100%;max-width:var(--maxw);margin:0 auto 34px;padding:18px;
    background:var(--glass);border:1px solid var(--border);border-radius:20px;box-shadow:var(--shadow);position:relative;
  }
  .hint{max-width:var(--maxw);margin:0 auto 10px;color:#d5e1ea;font-weight:700}
  .hint b{color:#fff}
  #wheel-area{position:relative;margin:18px auto 10px;width:320px;height:320px}
  #wheelCanvas{width:100%;height:100%;border:9px solid var(--neon);border-radius:50%;box-shadow:0 0 22px rgba(0,255,170,.35) inset, 0 0 30px rgba(0,255,170,.35);background:#06131d}
  .pointer{
    position:absolute;left:50%;bottom:-20px;transform:translateX(-50%) rotate(180deg);
    width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;border-top:22px solid #ff2c6f;
    filter:drop-shadow(0 0 10px rgba(255,44,111,.7))
  }

  .btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:10px}
  button{background:linear-gradient(90deg,var(--neon),var(--neon2));border:none;color:#001014;
    font-weight:900;font-size:18px;padding:10px 22px;border-radius:30px;cursor:pointer;box-shadow:0 10px 26px rgba(0,255,170,.3)}
  button:disabled{opacity:.6;cursor:not-allowed}
  .btn-ghost{background:rgba(255,255,255,.08);color:#fff;border:1px solid rgba(255,255,255,.14)}

  .stat{display:flex;justify-content:center;gap:14px;margin-top:10px;font-weight:800;color:#cfe6f3}
  .note{margin-top:8px;font-weight:800}
  .note.ok{color:#8affc4}.note.warn{color:#ffd166}
  .result{margin-top:14px;font-weight:900;font-size:20px}
  .win{color:#00ffaa}.lose{color:#ff5c8a}

  /* Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ø§Ø¦Ù… */
  .wa-fab{
    position:fixed;right:14px;top:14px;z-index:9;background:#ff7dc0;color:#1b0020;
    border-radius:999px;padding:10px 16px;display:flex;gap:10px;align-items:center;
    box-shadow:0 12px 30px rgba(0,0,0,.35);font-weight:900
  }
  .wa-fab img{width:22px;height:22px}
</style>
</head>
<body>

<a class="wa-fab" href="https://wa.me/201017908076?text=%D8%B7%D9%84%D8%A8%20%D9%83%D9%88%D8%AF%20%D8%B9%D8%AC%D9%84%D8%A9%20%D8%A7%D9%84%D8%AE%D9%85%D9%8A%D8%B3" target="_blank" rel="noopener">
  ØªÙˆØ§ØµÙ„ <img alt="phone" src="https://upload.wikimedia.org/wikipedia/commons/6/6b/Phone_font_awesome.svg">
</a>

<h1><span class="brand">Fly Express</span> â€” <span class="sub">Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ ğŸ¡</span></h1>
<p class="hint">Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø© ÙˆØ§ÙƒØ³Ø¨ Ø¬ÙˆØ§Ø¦Ø²Ùƒ! <b>Ø§Ù„Ø³Ù‡Ù… ØªØ­Øª</b> Ù‡Ùˆ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ù„Ù„ÙÙˆØ². Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØªØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙƒÙ„ <b>Ø®Ù…ÙŠØ³</b> Ø¨Ø¹Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„.</p>

<div class="wrap">
  <div id="wheel-area">
    <canvas id="wheelCanvas" width="320" height="320"></canvas>
    <div class="pointer"></div>
  </div>

  <div class="btns">
    <button id="activateBtn" class="btn-ghost">ğŸ”‘ ØªÙØ¹ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø®Ù…ÙŠØ³</button>
    <button id="spinBtn">ğŸ¯ Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©</button>
  </div>

  <div class="stat">
    <div>Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: <b id="left">0</b></div>
  </div>
  <div id="note" class="note"></div>
  <div id="result" class="result"></div>
</div>

<script>
/* ================= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… ================= */
const ATTEMPTS_PER_WEEK = 2;     // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„
const WEEK_PIN          = "2468"; // â† Ø­Ø· ÙƒÙˆØ¯ Ø§Ù„Ø®Ù…ÙŠØ³ Ù‡Ù†Ø§ ÙˆØªØºÙŠÙ‘Ø±Ù‡ ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹
/* =================================================== */

const canvas  = document.getElementById("wheelCanvas");
const ctx     = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");
const actBtn  = document.getElementById("activateBtn");
const result  = document.getElementById("result");
const leftEl  = document.getElementById("left");
const noteEl  = document.getElementById("note");

/* Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª */
const sectors = ["1","2","3","Ø­Ø¸ Ø£ÙˆÙØ±","0"];
const colors  = ["#0aa8ff","#7cd9ff","#0f6dc2","#ff2c6f","#1db8a9"];

let rotation = 0;    // Ø±Ø§Ø¯ÙŠØ§Ù†
let isSpinning = false;

/* Ø±Ø³Ù… Ø§Ù„Ø¹Ø¬Ù„Ø© */
function drawWheel(){
  const n = sectors.length, arc = 2*Math.PI/n;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<n;i++){
    const start = i*arc + rotation;
    ctx.beginPath();
    ctx.moveTo(160,160);
    ctx.arc(160,160,150,start,start+arc);
    ctx.fillStyle = colors[i]; ctx.fill();

    ctx.save();
    ctx.translate(160,160);
    ctx.rotate(start + arc/2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#fff";
    ctx.font = "bold 22px Cairo";
    ctx.fillText(sectors[i],128,8);
    ctx.restore();
  }
}

/* Ù…ÙØ§ØªÙŠØ­ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© */
function getThursdayKey(){
  const d=new Date(), diff=(4-d.getDay()+7)%7;
  const th=new Date(d.getFullYear(),d.getMonth(),d.getDate()+diff);
  return th.toISOString().split('T')[0];
}
function todayIsThursday(){ return new Date().getDay()===4; }

function loadState(){
  const wk = getThursdayKey();
  const savedWeek = localStorage.getItem("fx_week_key");
  const activated = localStorage.getItem("fx_activated_week") === wk;
  let left = +(localStorage.getItem("fx_left")||0);

  // Ù„Ùˆ Ø£Ø³Ø¨ÙˆØ¹ Ø¬Ø¯ÙŠØ¯â€”Ø§Ù„ØºÙ Ø§Ù„ØªÙØ¹ÙŠÙ„ ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª
  if(savedWeek !== wk){
    localStorage.setItem("fx_week_key", wk);
    localStorage.removeItem("fx_activated_week");
    left = 0;
    localStorage.setItem("fx_left", "0");
  }

  updateUI(left, activated);
  return {left, activated, wk};
}
function saveLeft(left){
  localStorage.setItem("fx_left", String(left));
  leftEl.textContent = left;
}

function updateUI(left, activated){
  leftEl.textContent = left;
  spinBtn.disabled = !activated || left<=0;
  if(!activated){
    noteEl.className='note warn';
    noteEl.textContent = "Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ù‚ÙÙˆÙ„Ø©. Ø§Ø¶ØºØ· (ØªÙØ¹ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø®Ù…ÙŠØ³) ÙˆØ£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.";
  }else if(left<=0){
    noteEl.className='note warn';
    noteEl.textContent = todayIsThursday()
      ? "Ø®Ù„ØµØª Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ âœ…"
      : "Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ Ø®Ù„ØµØª â€” Ø¬Ø±Ø¨ Ø§Ù„Ø®Ù…ÙŠØ³ Ø§Ù„Ø¬Ø§ÙŠ âœ¨";
  }else{
    noteEl.className='note';
    noteEl.textContent = "";
  }
}

function activateWeek(){
  const pin = prompt("Ø§Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®Ù…ÙŠØ³:");
  if(pin === null) return;
  if(pin === WEEK_PIN){
    localStorage.setItem("fx_activated_week", getThursdayKey());
    localStorage.setItem("fx_left", String(ATTEMPTS_PER_WEEK));
    const {left, activated} = loadState();
    updateUI(left, activated);
    alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ âœ…");
  }else{
    alert("Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ âŒ");
  }
}

let state = loadState();

/* Ø§Ù„Ø³Ù‡Ù… Ù„Ø£Ø³ÙÙ„ */
const POINTER_ANGLE = Math.PI/2;

/* Ø¯ÙˆØ±Ø§Ù† */
function spin(){
  state = loadState();
  if(isSpinning || !state.activated || state.left<=0) return;

  isSpinning = true; spinBtn.disabled = true; result.textContent = "";

  const spins = 5 + Math.random()*5;
  const finalAngle = rotation + spins * (2*Math.PI);
  const duration = 4200;
  const startT = performance.now();

  function anim(now){
    const t = Math.min((now - startT)/duration, 1);
    const easeOut = 1 - Math.pow(1 - t, 3);
    rotation = (finalAngle * easeOut) % (2*Math.PI);
    drawWheel();
    if(t<1){ requestAnimationFrame(anim); }
    else{
      const n=sectors.length, arc=2*Math.PI/n;
      const rel = (POINTER_ANGLE - (rotation % (2*Math.PI)) + 2*Math.PI) % (2*Math.PI);
      const index = Math.floor(rel / arc) % n;
      const val = sectors[index];

      // Ø®ØµÙ… Ù…Ø­Ø§ÙˆÙ„Ø©
      const left = Math.max(0, state.left-1);
      saveLeft(left);

      if(val === "Ø­Ø¸ Ø£ÙˆÙØ±"){
        result.innerHTML = "ğŸ˜” <span class='lose'>Ø­Ø¸ Ø£ÙˆÙØ±! Ø¬Ø±Ø¨ ØªØ§Ù†ÙŠ</span>";
      }else{
        result.innerHTML = `ğŸ‰ <span class='win'>Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ${val} ØªÙˆØµÙŠÙ„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ©</span>`;
      }
      isSpinning = false;
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ù„Ù„Ø²Ø± ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡
      updateUI(left, true);
    }
  }
  requestAnimationFrame(anim);
}

drawWheel();
spinBtn.addEventListener("click", spin);
actBtn.addEventListener("click", activateWeek);
</script>
</body>
</html>
