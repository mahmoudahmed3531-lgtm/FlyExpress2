<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Express â€” Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    --size: 310px;        /* Ù‚Ø·Ø± Ø§Ù„Ø¹Ø¬Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    --ring: #00ffb3;      /* Ù„ÙˆÙ† Ø§Ù„Ø­Ù„Ù‚Ø© */
    --bg: #0c1320;
    --panel: rgba(255,255,255,.06);
    --text: #e9eef3;
    --muted:#aac0d0;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Cairo',system-ui,sans-serif; color:var(--text);
    background:
      radial-gradient(900px 500px at 10% 15%, #0a1a2f 0%, transparent 65%),
      radial-gradient(900px 500px at 90% 85%, #00131f 0%, transparent 65%),
      #07101c;
    display:flex; justify-content:center; padding:22px;
  }
  .wrap{width:100%; max-width:520px}

  h1{
    margin:0 0 6px; font-size:34px; font-weight:800; text-align:center;
  }
  .sub{ text-align:center; color:#63ff9c; font-size:28px; font-weight:800; margin-bottom:10px }
  .icon{font-size:28px; margin-inline:8px}

  .card{
    background:var(--panel); border:1px solid rgba(255,255,255,.08);
    border-radius:18px; padding:16px; backdrop-filter: blur(6px);
    box-shadow: 0 18px 40px rgba(0,0,0,.35);
  }

  /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ø¬Ù„Ø© */
  .wheel-box{ position:relative; display:flex; justify-content:center; align-items:center; padding-top:10px }
  .ring{
    position:absolute; width:calc(var(--size) + 18px); height:calc(var(--size) + 18px);
    border-radius:50%;
    box-shadow: 0 0 0 9px rgba(0,255,179,.15), inset 0 0 18px rgba(0,255,179,.4);
    outline: 5px solid var(--ring);
    filter: drop-shadow(0 0 20px rgba(0,255,179,.35));
  }
  .wheel{
    width:var(--size); height:var(--size); border-radius:50%;
    background: conic-gradient(
      #0aa8ff 0deg 72deg,       /* 1 */
      #c8f2ff 72deg 144deg,     /* 2 */
      #0f87c7 144deg 216deg,    /* 3 */
      #ff2c6f 216deg 288deg,    /* Ø­Ø¸ Ø£ÙˆÙØ± */
      #1db8a9 288deg 360deg     /* 0 */
    );
    transition: transform 4.2s cubic-bezier(.18,.85,.24,1);
    position:relative;
  }
  /* Ù„ÙŠØ¨Ù„Ø§Øª Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª */
  .wheel .label{
    position:absolute; left:50%; top:50%;
    transform-origin: center;
    font-weight:800; color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.55);
  }
  .wheel .label span{ display:inline-block; transform: translate(-50%,-50%); }

  /* ØªÙ…ÙˆØ¶Ø¹ ÙƒÙ„ Ù„ÙŠØ¨Ù„ Ø¹Ù†Ø¯ Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ø·Ø§Ø¹ */
  /* 5 Ù‚Ø·Ø§Ø¹Ø§Øª => ÙƒÙ„ 72Â° . Ù†Ø­Ø±Ùƒ ÙƒÙ„ Ù„ÙŠØ¨Ù„ Ø¨Ø²Ø§ÙˆÙŠØªÙ‡ Ùˆ Ù†Ø¨Ø¹Ø¯Ù‡ Ù„Ù†Øµ Ø§Ù„Ù‚Ø·Ø± */
  .w-l0{ transform: rotate(36deg) translate(calc(var(--size)/2.6)) rotate(-36deg); }   /* 1 */
  .w-l1{ transform: rotate(36+72deg) translate(calc(var(--size)/2.6)) rotate(-(36+72deg)); } /* 2 */
  .w-l2{ transform: rotate(36+144deg) translate(calc(var(--size)/2.6)) rotate(-(36+144deg)); }/* 3 */
  .w-l3{ transform: rotate(36+216deg) translate(calc(var(--size)/2.6)) rotate(-(36+216deg)); }/* Ø­Ø¸ Ø£ÙˆÙØ± */
  .w-l4{ transform: rotate(36+288deg) translate(calc(var(--size)/2.6)) rotate(-(36+288deg)); }/* 0 */

  .badge-big{ font-size:38px }
  .badge-mid{ font-size:34px }

  /* Ø§Ù„Ø³Ù‡Ù… Ù„ØªÙ€Ù€Ø­Øª */
  .pointer{
    position:absolute; left:50%; bottom:-18px; transform:translateX(-50%) rotate(180deg);
    width:0; height:0;
    border-left:14px solid transparent; border-right:14px solid transparent;
    border-top:22px solid #ff004c;
    filter: drop-shadow(0 0 8px rgba(255,0,76,.6));
  }

  .cta{ display:flex; justify-content:center; margin:16px 0 6px }
  button{
    background: linear-gradient(90deg,#00d18f,#00a8ff);
    border:none; color:#fff; font-weight:800; font-size:18px;
    padding:12px 20px; border-radius:999px; cursor:pointer;
    box-shadow:0 14px 32px rgba(0,168,255,.25); transition: transform .12s ease, filter .12s ease;
  }
  button:disabled{ filter:grayscale(.6) brightness(.75); cursor:not-allowed }
  button:not(:disabled):active{ transform: translateY(1px) scale(.99) }

  .info{
    margin-top:8px; background:rgba(255,255,255,.05);
    border:1px solid rgba(255,255,255,.08);
    border-radius:14px; padding:12px; text-align:center; color:var(--muted)
  }
  .info strong{ color:#fff }
  .pill{
    display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px;
    background:rgba(255,255,255,.08); font-weight:800; color:#fff; margin-inline:6px;
  }
  .ok{color:#63ff9c}
  .result{
    margin-top:14px; font-size:20px; text-align:center; font-weight:800
  }
  .result.win{ color:#63ff9c }
  .result.lose{ color:#ffd166 }
  .tiny{font-size:12px; opacity:.9; margin-top:6px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Fly Express â€” <span style="color:#27ff92">Ø¹Ø¬Ù„Ø©</span></h1>
    <div class="sub"><span class="icon">ğŸ¡</span>Ø§Ù„Ø­Ø¸</div>

    <div class="card">
      <div class="wheel-box">
        <div class="ring" aria-hidden="true"></div>

        <div id="wheel" class="wheel" role="img" aria-label="Ø¹Ø¬Ù„Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²">
          <!-- Ù„ÙŠØ¨Ù„Ø§Øª Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª -->
          <div class="label w-l0"><span class="badge-mid">1</span></div>
          <div class="label w-l1"><span class="badge-mid">2</span></div>
          <div class="label w-l2"><span class="badge-mid">3</span></div>
          <div class="label w-l3"><span class="badge-big">Ø­Ø¸ Ø£ÙˆÙØ±</span></div>
          <div class="label w-l4"><span class="badge-mid">0</span></div>
        </div>

        <div class="pointer" aria-hidden="true"></div>
      </div>

      <div class="cta"><button id="spinBtn">ğŸ¯ Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©</button></div>

      <div class="info">
        Ù„Ø¯ÙŠÙƒ <span class="pill"><strong id="left">0</strong> Ù…Ø­Ø§ÙˆÙ„Ø§Øª</span>.
        ØªØªØ¬Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒÙ„ <strong>Ø®Ù…ÙŠØ³</strong>.<br>
        <span class="tiny">Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø®Ù…ÙŠØ³ â€” ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ <span id="isThu" class="ok">âœ“</span></span>
      </div>

      <div id="out" class="result"></div>
    </div>
  </div>

<script>
/* ========= Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ========= */
const PRIZES = [
  {label:'1', value:1},
  {label:'2', value:2},
  {label:'3', value:3},
  {label:'Ø­Ø¸ Ø£ÙˆÙØ±', value:'lose'},
  {label:'0', value:0},
];
// ØªØ±ØªÙŠØ¨ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª = Ù†ÙØ³ ØªØ±ØªÙŠØ¨ conic-gradient Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰
// ÙƒÙ„ Ù‚Ø·Ø§Ø¹ 72Â°ØŒ ÙˆÙ…Ø±ÙƒØ²Ù‡ ÙƒÙ„ (36Â° + 72Â°*i)

const urlParams = new URLSearchParams(location.search);
const DEBUG = urlParams.get('debug') === '1';  // ?debug=1 ÙŠØ¹Ø·ÙŠ 99 Ù…Ø­Ø§ÙˆÙ„Ø©

const wheel = document.getElementById('wheel');
const btn   = document.getElementById('spinBtn');
const leftEl= document.getElementById('left');
const out   = document.getElementById('out');
const isThu = document.getElementById('isThu');

/* ========= Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ù…ÙŠØ³ ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ========= */
function thursdayKeyFor(d=new Date()){
  // Ø§Ø­Ø³Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®Ù…ÙŠØ³ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ø¨ÙˆØ¹
  const day = d.getDay();          // 0=Ø§Ù„Ø£Ø­Ø¯ .. 6=Ø§Ù„Ø³Ø¨Øª
  const diffToThu = ((4 - day) + 7) % 7; // 4 = Ø§Ù„Ø®Ù…ÙŠØ³
  const th = new Date(d.getFullYear(), d.getMonth(), d.getDate() + diffToThu);
  const yyyy = th.getFullYear();
  const mm = String(th.getMonth()+1).padStart(2,'0');
  const dd = String(th.getDate()).padStart(2,'0');
  return `${yyyy}-${mm}-${dd}`;
}

function loadQuota(){
  if (DEBUG){
    localStorage.setItem('spins_left','99');
    localStorage.setItem('spin_thursday_key', thursdayKeyFor());
  }

  const currentKey = thursdayKeyFor();
  const savedKey = localStorage.getItem('spin_thursday_key');
  let left = Number(localStorage.getItem('spins_left') || 0);

  if (savedKey !== currentKey){
    left = 2; // Ù…Ø­Ø§ÙˆÙ„ØªØ§Ù† Ø¬Ø¯ÙŠØ¯ØªØ§Ù†
    localStorage.setItem('spin_thursday_key', currentKey);
    localStorage.setItem('spins_left', String(left));
  }
  updateUI(left);
  return left;
}

function updateUI(left){
  leftEl.textContent = left;
  btn.disabled = left <= 0;
  const todayKey = thursdayKeyFor(new Date());
  const savedKey = localStorage.getItem('spin_thursday_key');
  isThu.style.visibility = (savedKey === todayKey) ? 'visible' : 'hidden';
}

function setLeft(n){
  localStorage.setItem('spins_left', String(n));
  updateUI(n);
}

/* ========= Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø¹Ø¬Ù„Ø© ========= */
let spinning = false;

function spin(){
  if (spinning) return;
  let left = Number(localStorage.getItem('spins_left') || 0);
  if (left <= 0){ out.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©.'; out.className='result'; return; }

  spinning = true; btn.disabled = true; out.textContent=''; out.className='result';

  const idx = Math.floor(Math.random()*PRIZES.length); // 0..4
  // Ø²Ø§ÙˆÙŠØ© Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:
  // Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ø·Ø§Ø¹ i = 36Â° + 72Â°*i
  const targetMid = 36 + 72*idx;

  // Ù„Ø£Ù† Ø§Ù„Ø³Ù‡Ù… Ù„ØªØ­Øª => +90Â°
  const turns = 6; // Ù„Ù„ÙØ§Øª ÙƒØ«ÙŠØ±Ø© Ø´ÙƒÙ„Ù‡Ø§ Ø£Ø­Ù„Ù‰
  const finalDeg = (turns*360) + targetMid + 90;

  wheel.style.transform = `rotate(${finalDeg}deg)`;

  // Ø¨Ø¹Ø¯ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
  setTimeout(()=>{
    spinning = false;
    left -= 1; setLeft(left); // Ø§Ø³ØªÙ‡Ù„Ùƒ Ù…Ø­Ø§ÙˆÙ„Ø©

    const res = PRIZES[idx];
    if (res.value === 'lose'){
      out.textContent = 'Ø­Ø¸ Ø£ÙˆÙØ±! Ø¬Ø±Ù‘Ø¨ Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ø¬Ø§ÙŠØ© ğŸ‘€';
      out.className = 'result lose';
    }else{
      out.textContent = `Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ${res.value} ØªÙˆØµÙŠÙ„Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ© ğŸ‰`;
      out.className = 'result win';
    }
    btn.disabled = left <= 0;
  }, 4300);
}

/* ========= ØªØ´ØºÙŠÙ„ ========= */
btn.addEventListener('click', spin);
loadQuota();
</script>
</body>
</html>
