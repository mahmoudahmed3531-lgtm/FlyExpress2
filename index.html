<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Express â€” Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  :root{
    --bg1:#061423;
    --bg2:#001d2b;
    --ring:#18f5c6;
    --text:#eaf6ff;
    --muted:#9fb3c8;
    --win:#22c55e;
    --loss:#ef4444;
    --accent:#00d4ff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); font-family:'Cairo',system-ui,sans-serif;
    display:flex; align-items:flex-start; justify-content:center; padding:22px;
    background:
      radial-gradient(900px 600px at 10% 10%, #0b1a2a 0%, transparent 60%),
      radial-gradient(900px 600px at 90% 90%, #051a2a 0%, transparent 60%),
      conic-gradient(from 0deg at 50% 50%, #02121e, #05243a, #0a2d45, #05243a, #02121e);
    background-size:140% 140%,140% 140%,200% 200%;
    animation:bgmove1 16s ease-in-out infinite, bgmove2 18s ease-in-out infinite, hue 28s linear infinite;
  }
  @keyframes bgmove1{0%,100%{background-position:10% 10%,90% 90%,0% 50%}50%{background-position:30% 20%,70% 80%,100% 50%}}
  @keyframes bgmove2{0%,100%{background-position:10% 10%,90% 90%,0% 50%}50%{background-position:15% 25%,85% 75%,100% 50%}}
  @keyframes hue{0%{filter:hue-rotate(0deg)}100%{filter:hue-rotate(360deg)}}

  .wrap{width:100%; max-width:540px}
  .card{
    background:rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.08);
    border-radius:22px;
    box-shadow:0 18px 50px rgba(0,0,0,.28);
    backdrop-filter: blur(8px);
    overflow:hidden;
  }
  .header{
    padding:18px 18px 10px; text-align:center;
  }
  .title{
    font-size:30px; font-weight:800; letter-spacing:.5px; margin:0 0 6px;
  }
  .sub{
    font-size:14px; color:var(--muted); margin:0;
  }
  .promo{
    margin:14px auto 8px; width:max-content; padding:8px 16px; border-radius:999px;
    background:linear-gradient(90deg,#25d366,#00d4ff,#a78bfa);
    color:#04121f; font-weight:800; box-shadow:0 10px 24px rgba(0,0,0,.3);
    animation:float 4s ease-in-out infinite;
  }
  @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-4px)}}

  /* Wheel area */
  .stage{padding:14px 14px 8px}
  .arena{
    position:relative; margin:0 auto; width:320px; height:320px;
    border-radius:50%;
    display:grid; place-items:center;
  }
  /* ring glow */
  .arena::before{
    content:""; position:absolute; inset:-10px; border-radius:50%;
    background: radial-gradient(closest-side, rgba(24,245,198,.2), transparent 70%);
    filter:blur(8px);
  }
  .wheel{
    position:relative; width:100%; height:100%; border-radius:50%;
    border:10px solid var(--ring);
    box-shadow: inset 0 0 0 6px #04121f, 0 0 0 4px #01212f;
    display:grid; place-items:center;
    transition: transform 6s cubic-bezier(.17,.67,.07,1);
    /* 5 Ø´Ø±Ø§Ø¦Ø­ Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
    background:
      conic-gradient(
        #18a1c7 0deg 72deg,          /* 0 */
        #a7e3ff 72deg 144deg,        /* 1 */
        #0c80d7 144deg 216deg,       /* 2 */
        #ff4b7d 216deg 288deg,       /* Ø­Ø¸ Ø£ÙˆÙØ± */
        #2fb6a1 288deg 360deg        /* 3 */
      );
  }
  .labels{
    position:absolute; inset:0; display:grid; place-items:center; pointer-events:none;
  }
  .labels span{
    position:absolute; font-weight:800; font-size:34px; color:#fff; text-shadow:0 4px 14px rgba(0,0,0,.45);
  }
  /* Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù†ØµÙˆØµ Ø¹Ù†Ø¯ ÙˆØ³Ø· ÙƒÙ„ Ø´Ø±ÙŠØ­Ø© */
  .lab-0{ transform: rotate(36deg) translate(0,-120px) rotate(-36deg); }
  .lab-1{ transform: rotate(36+72deg) translate(0,-120px) rotate(-108deg); }
  .lab-2{ transform: rotate(36+144deg) translate(0,-120px) rotate(-180deg); }
  .lab-luck{ transform: rotate(36+216deg) translate(0,-120px) rotate(-252deg); font-size:32px }
  .lab-3{ transform: rotate(36+288deg) translate(0,-120px) rotate(-324deg); }

  /* Ø§Ù„Ø³Ù‡Ù… (ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ â€“ ÙŠØ´ÙŠØ± Ù„Ø£Ø¹Ù„Ù‰) */
  .pointer{
    position:absolute; bottom:-14px; left:50%; transform:translateX(-50%);
    width:0; height:0;
    border-left:16px solid transparent;
    border-right:16px solid transparent;
    border-top:26px solid #ff2f5e;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,.5));
  }

  .cta{
    display:flex; gap:10px; justify-content:center; margin:14px 0 6px;
  }
  button{
    border:none; border-radius:999px; padding:12px 22px; font-weight:800; color:#00131f;
    background:linear-gradient(90deg,#34f5c6,#00d4ff); box-shadow:0 12px 28px rgba(0,0,0,.34);
    cursor:pointer; transition: transform .12s ease, filter .12s ease;
  }
  button:hover{ transform:translateY(-2px); filter:brightness(1.08) }
  button:disabled{ opacity:.6; cursor:not-allowed; transform:none; }

  .panel{
    margin:8px 14px 18px; padding:12px; border-radius:14px;
    background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
  }
  .row{display:flex; justify-content:space-between; gap:10px; align-items:center; margin:6px 0}
  .caps{color:var(--muted); font-weight:700}
  .value{font-weight:800}

  .xpbar{
    height:12px; background:rgba(255,255,255,.08); border-radius:999px; overflow:hidden; margin-top:6px;
  }
  .xpbar>div{
    height:100%; width:0%; background:linear-gradient(90deg,#22c55e,#00d4ff);
    box-shadow:0 8px 16px rgba(0,0,0,.25); transition:width .5s ease;
  }

  .rewards{margin:14px; padding:12px; border-radius:14px; border:1px dashed rgba(255,255,255,.2); color:var(--muted); font-weight:700}
  .rewards b{color:#fff}

  .toast{
    margin:10px 14px 16px; padding:12px 14px; border-radius:12px; text-align:center; font-weight:800;
    background:rgba(34,197,94,.12); border:1px solid rgba(34,197,94,.35);
    display:none;
  }
  .toast.err{ background:rgba(239,68,68,.12); border-color: rgba(239,68,68,.35); }

  .foot{color:var(--muted); text-align:center; font-size:12px; margin:10px 0 4px}

  /* helpers for math in CSS transforms */
  .lab-1{ transform: rotate(108deg) translate(0,-120px) rotate(-108deg); }
  .lab-2{ transform: rotate(180deg) translate(0,-120px) rotate(-180deg); }
  .lab-luck{ transform: rotate(252deg) translate(0,-120px) rotate(-252deg); }
  .lab-3{ transform: rotate(324deg) translate(0,-120px) rotate(-324deg); }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <div class="title">Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ â€” <span style="color:#38f0c8">Fly Express</span></div>
        <div class="promo">ğŸ Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø© ÙˆØ§ÙƒØ³Ø¨ Ø¬ÙˆØ§Ø¦Ø²Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©!</div>
        <p class="sub">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØªØªØ¬Ø¯Ø¯ ÙƒÙ„ Ø®Ù…ÙŠØ³ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</p>
      </div>

      <div class="stage">
        <div class="arena">
          <div id="wheel" class="wheel">
            <div class="labels">
              <span class="lab-0">0</span>
              <span class="lab-1">1</span>
              <span class="lab-2">2</span>
              <span class="lab-luck">Ø­Ø¸ Ø£ÙˆÙØ±</span>
              <span class="lab-3">3</span>
            </div>
          </div>
          <div class="pointer"></div>
        </div>

        <div class="cta">
          <button id="spinBtn"><i class="fa-solid fa-bullseye"></i> Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©</button>
          <button id="howBtn" style="background:linear-gradient(90deg,#a78bfa,#60a5fa);"><i class="fa-solid fa-circle-question"></i> Ø§Ø²Ø§ÙŠ Ø£ÙƒØ³Ø¨ØŸ</button>
        </div>

        <div id="toast" class="toast"></div>

        <div class="panel">
          <div class="row">
            <div class="caps">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</div>
            <div class="value"><span id="triesLeft">0</span></div>
          </div>
          <div class="row">
            <div class="caps">Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</div>
            <div class="value">Lv <span id="level">1</span> â€” <span id="xpText">0 / 100 XP</span></div>
          </div>
          <div class="xpbar"><div id="xpFill"></div></div>
        </div>

        <div class="rewards">
          ğŸ† <b>Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²:</b><br>
          â€¢ 0 = ÙˆÙ„Ø§ ØªÙˆØµÙŠÙ„Ù‡ ğŸ˜… â€” +2 XP<br>
          â€¢ 1 = ØªÙˆØµÙŠÙ„Ù‡ Ù…Ø¬Ø§Ù†ÙŠØ© ğŸš— â€” +12 XP<br>
          â€¢ 2 = ØªÙˆØµÙŠÙ„ØªÙŠÙ† Ù…Ø¬Ø§Ù†ÙŠØªÙŠÙ† ğŸš€ â€” +25 XP<br>
          â€¢ 3 = 3 ØªÙˆØµÙŠÙ„Ø§Øª + Ø¨ÙˆÙ†Øµ ğŸ’¥ â€” +40 XP<br>
          â€¢ "Ø­Ø¸ Ø£ÙˆÙØ±" = Ù…ÙÙŠØ´ Ø¬Ø§ÙŠØ²Ø©â€¦ Ø¨Ø³ +5 XP Ù„Ù„ØªØ³Ù„ÙŠØ© ğŸ˜‰
        </div>

        <p class="foot">Ø§Ù„Ø³Ù‡Ù… Ø£Ø³ÙÙ„ Ø§Ù„Ø¹Ø¬Ù„Ø© Ù‡Ùˆ Ø§Ù„Ù…Ø­Ø¯Ù‘ÙØ¯ Ù„Ù„Ù†ØªÙŠØ¬Ø©.</p>
      </div>
    </div>
  </div>

<script>
/* ========= Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (ØªÙ‚Ø¯Ø± ØªØºÙŠÙ‘Ø±Ù‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©) ========= */
const CONFIG = {
  attemptsPerThursday: 2,     // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒÙ„ Ø®Ù…ÙŠØ³
  xpPerOutcome: {             // Ù†Ù‚Ø§Ø· Ø§Ù„Ø®Ø¨Ø±Ø© Ù„ÙƒÙ„ Ù†ØªÙŠØ¬Ø©
    '0': 2,
    '1': 12,
    '2': 25,
    '3': 40,
    'Ø­Ø¸ Ø£ÙˆÙØ±': 5
  },
  baseXpToLevel: 100,         // XP Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ 2
  levelScale: 0.35            // ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰ ÙŠØ²ÙˆØ¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¨Ù†Ø³Ø¨Ø© 35%
};
/* ==================================================== */

const wheel = document.getElementById('wheel');
const spinBtn = document.getElementById('spinBtn');
const howBtn  = document.getElementById('howBtn');
const toast   = document.getElementById('toast');

const triesLeftEl = document.getElementById('triesLeft');
const levelEl     = document.getElementById('level');
const xpTextEl    = document.getElementById('xpText');
const xpFillEl    = document.getElementById('xpFill');

const LS_KEYS = {
  tries: 'fx_wheel_tries',
  week:  'fx_wheel_week',
  rot:   'fx_wheel_rotation',
  xp:    'fx_xp',
  lvl:   'fx_level'
};

// ØªØ±ØªÙŠØ¨ Ø§Ù„Ø´Ø±Ø§Ø¦Ø­ (Ù…Ø¹ Ù†ÙØ³ ØªØ±ØªÙŠØ¨ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù€ conic-gradient)
const SEGMENTS = ['0','1','2','Ø­Ø¸ Ø£ÙˆÙØ±','3']; // 5 Ø´Ø±Ø§Ø¦Ø­
const SEG_SIZE = 360 / SEGMENTS.length;       // = 72 Ø¯Ø±Ø¬Ø©
const PICK_DEG = 270; // Ø§Ù„Ø³Ù‡Ù… ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ (Ø£Ø³ÙÙ„ = 270Â° Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ†)

let state = {
  rotation: Number(localStorage.getItem(LS_KEYS.rot) || 0),
  tries: 0,
  xp: Number(localStorage.getItem(LS_KEYS.xp) || 0),
  level: Number(localStorage.getItem(LS_KEYS.lvl) || 1),
};

/* ======= Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ======= */
function currentWeekStamp(){
  const d = new Date();
  // Ù†Ø­Ø³Ø¨ Ø®Ù…ÙŠØ³ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
  const day = d.getDay(); // 0=Ø£Ø­Ø¯ .. 4=Ø®Ù…ÙŠØ³
  // Ù†Ø³ØªØ®Ø¯Ù… Ø±Ù‚Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ù…Ù† Ø§Ù„Ø³Ù†Ø© + Ø§Ù„Ø³Ù†Ø©
  const oneJan = new Date(d.getFullYear(),0,1);
  const week = Math.floor((((d - oneJan)/86400000) + oneJan.getDay()+1)/7);
  return `${d.getFullYear()}-W${week}`;
}

function resetTriesIfThursday(){
  const savedWeek = localStorage.getItem(LS_KEYS.week);
  const now = new Date();
  const isThursday = now.getDay() === 4; // 4 = Ø®Ù…ÙŠØ³
  const stamp = currentWeekStamp();
  if (isThursday && savedWeek !== stamp){
    state.tries = CONFIG.attemptsPerThursday;
    localStorage.setItem(LS_KEYS.week, stamp);
    localStorage.setItem(LS_KEYS.tries, String(state.tries));
  }else{
    const stored = Number(localStorage.getItem(LS_KEYS.tries));
    state.tries = Number.isFinite(stored) ? stored : 0;
  }
}
function saveState(){
  localStorage.setItem(LS_KEYS.rot, String(state.rotation));
  localStorage.setItem(LS_KEYS.tries, String(state.tries));
  localStorage.setItem(LS_KEYS.xp, String(state.xp));
  localStorage.setItem(LS_KEYS.lvl, String(state.level));
}
function xpNeeded(level){
  // Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
  return Math.round(CONFIG.baseXpToLevel * (1 + CONFIG.levelScale*(level-1)));
}
function addXP(amount){
  state.xp += amount;
  let needed = xpNeeded(state.level);
  let leveled = false;
  while(state.xp >= needed){
    state.xp -= needed;
    state.level += 1;
    needed = xpNeeded(state.level);
    leveled = true;
  }
  if (leved) {} // dummy to avoid typo if refactor
  return leveled;
}
function updateUI(){
  triesLeftEl.textContent = state.tries;
  levelEl.textContent = state.level;
  const need = xpNeeded(state.level);
  xpTextEl.textContent = `${state.xp} / ${need} XP`;
  xpFillEl.style.width = Math.min(100, Math.round(state.xp*100/need)) + '%';
  wheel.style.transform = `rotate(${state.rotation}deg)`;
}
function showToast(msg, ok=true){
  toast.textContent = msg;
  toast.classList.toggle('err', !ok);
  toast.style.display = 'block';
  setTimeout(()=> toast.style.display='none', 2800);
}

function spin(){
  if (state.tries <= 0){
    showToast('Ù…ÙÙŠØ´ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©. Ø¬Ø±Ù‘Ø¨ Ø§Ù„Ø®Ù…ÙŠØ³ Ø§Ù„Ø¬Ø§ÙŠ ğŸ™', false);
    return;
  }
  spinBtn.disabled = true;

  // Ù„ÙØ© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© 5 Ø¥Ù„Ù‰ 8 Ø¯ÙˆØ±Ø§Øª + Ø¹Ø´ÙˆØ§Ø¦ÙŠ 0..359
  const extra = 360* (5 + Math.floor(Math.random()*4)) + Math.floor(Math.random()*360);
  state.rotation = (state.rotation + extra) % (360*100000); // Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù‚ÙŠÙ…Ø© Ù…Ø¹Ù‚ÙˆÙ„Ø©
  wheel.style.transform = `rotate(${state.rotation}deg)`;

  // Ù†Ù†ØªØ¸Ø± Ø²Ù…Ù† Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø«Ù… Ù†Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
  setTimeout(()=>{
    const rot = state.rotation % 360;
    // Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¬Ù‡Ø© Ù„Ù„Ø³Ù‡Ù… (Ø£Ø³ÙÙ„) Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
    const selectedAngle = (PICK_DEG - rot + 360) % 360; // 0..359
    const index = Math.floor(selectedAngle / SEG_SIZE);
    const result = SEGMENTS[index];

    state.tries -= 1;

    // XP + Ø±Ø³Ø§Ù„Ø©
    const gained = CONFIG.xpPerOutcome[result] || 0;
    const leveled = addXP(gained);

    // Ø±Ø³Ø§Ù„Ø© Ù†ØªÙŠØ¬Ø©
    if (result === 'Ø­Ø¸ Ø£ÙˆÙØ±'){
      showToast(`Ø­Ø¸ Ø£ÙˆÙØ±! (+${gained} XP)`, false);
    }else{
      const txt = Number(result)===0 ? 'ÙˆÙ„Ø§ ØªÙˆØµÙŠÙ„Ù‡' : (Number(result)===1?'ØªÙˆØµÙŠÙ„Ù‡':'ØªÙˆØµÙŠÙ„Ø§Øª');
      const num = Number(result);
      showToast(`Ù…Ø¨Ø±ÙˆÙƒ! ÙƒØ³Ø¨Øª ${num} ${txt} Ù…Ø¬Ø§Ù†ÙŠØ© ğŸ‰ (+${gained} XP)`, true);
    }
    if (leveled){
      setTimeout(()=>showToast(`Ø§Ø±ØªÙ‚ÙŠØª Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${state.level}! ğŸ”¥`, true), 1200);
    }

    saveState();
    updateUI();
    spinBtn.disabled = false;
  }, 6100); // Ù†ÙØ³ Ù…Ø¯Ø© transition ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§
}

/* ======= ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ ======= */
resetTriesIfThursday();
updateUI();

/* ======= Ø£Ø­Ø¯Ø§Ø« ======= */
spinBtn.addEventListener('click', spin);

howBtn.addEventListener('click', ()=>{
  showToast('Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©â€¦ Ø§Ù„Ø³Ù‡Ù… Ø§Ù„Ù„ÙŠ ØªØ­Øª Ù‡Ùˆ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ù„Ù†ØªÙŠØ¬Ø©. Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¨ØªØªØ¬Ø¯Ø¯ ÙƒÙ„ Ø®Ù…ÙŠØ³ âœ¨');
});
</script>
</body>
</html>
