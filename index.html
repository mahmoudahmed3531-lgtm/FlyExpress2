<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fly Express — عجلة الحظ</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  :root{--neon:#1df2c2;--text:#eaf2f6;--muted:#b8c3cc}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:"Cairo",system-ui,sans-serif;color:var(--text);padding:20px;
    background:
      radial-gradient(1200px 700px at 10% 10%, #0a2030 0%, transparent 60%),
      radial-gradient(1200px 700px at 90% 90%, #051621 0%, transparent 60%),
      linear-gradient(180deg,#071420,#0a2538 60%,#071420);
    background-size:140% 140%,140% 140%,100% 100%;
  }
  .wrap{max-width:720px;margin:0 auto}
  header{margin-bottom:14px}
  header h1{margin:0 0 6px;font-size:28px;font-weight:800}
  header .sub{color:var(--muted);font-weight:700}
  .card{
    background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.07);
    backdrop-filter:blur(8px);border-radius:18px;padding:18px;box-shadow:0 18px 48px rgba(0,0,0,.35)
  }

  .stage{display:grid;place-items:center;gap:12px;margin-top:8px}
  .wheel-shell{
    width:min(88vw,480px);aspect-ratio:1/1;border-radius:50%;
    box-shadow:0 0 0 10px var(--neon), 0 0 30px #1df2c28c, inset 0 0 0 10px #101;
    display:grid;place-items:center;background:#0002
  }
  svg{width:92%;height:92%;overflow:visible}
  .rotor{transition:transform 6s cubic-bezier(.15,.8,.05,1);transform-origin:50% 50%}
  .hub{fill:#0b0b0b}
  .pointer{
    width:0;height:0;border-left:16px solid transparent;border-right:16px solid transparent;border-top:28px solid #ff477e;
    filter:drop-shadow(0 6px 10px rgba(0,0,0,.45));margin-top:6px
  }

  .btns{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:8px}
  button{
    border:0;border-radius:999px;padding:12px 22px;font-weight:800;cursor:pointer;
    background:linear-gradient(135deg,#22e6a7,#24b6ff);color:#012;box-shadow:0 12px 22px rgba(0,0,0,.35)
  }
  button:disabled{opacity:.6;cursor:not-allowed}
  .result{margin:14px 0 6px;text-align:center;font-size:22px;font-weight:800;color:#00ffc3}
  .status{ text-align:center;color:#cfe7f2;font-weight:700 }
  .badge{display:inline-flex;gap:8px;align-items:center;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);padding:8px 12px;border-radius:12px}

  .call{position:fixed;right:18px;top:18px;background:#ff6bd6;color:#101;padding:12px 14px;border-radius:999px;text-decoration:none;font-weight:800;box-shadow:0 12px 26px rgba(0,0,0,.35)}
</style>
</head>
<body>
  <a class="call" href="tel:+201017908076">📞 تواصل</a>

  <div class="wrap">
    <header>
      <h1>🎡 عجلة الحظ — <span style="color:#39f5c7">Fly Express</span></h1>
      <div class="sub">لف العجلة واكسب جوائزك؛ <b>السهم لتحت</b> هو المرجع للفوز. المحاولات تتجدد تلقائيًا كل <b>خميس</b>.</div>
    </header>

    <div class="card">
      <div class="stage">
        <div class="wheel-shell">
          <!-- SVG WHEEL -->
          <svg viewBox="0 0 100 100" aria-label="Wheel">
            <!-- المجموعة الدوّارة -->
            <g id="rotor" class="rotor"></g>
            <!-- حلقة خارجية خفيفة -->
            <circle cx="50" cy="50" r="48" fill="none" stroke="rgba(255,255,255,.08)" stroke-width="1.5"/>
            <!-- الهَب (الدائرة الداخلية) -->
            <circle class="hub" cx="50" cy="50" r="12"/>
          </svg>
        </div>
        <div class="pointer" aria-hidden="true"></div>
      </div>

      <div class="btns">
        <button id="spinBtn">🎯 لف العجلة</button>
        <button id="howBtn" style="background:linear-gradient(135deg,#d4ecff,#a9e9c9)">❓ إزاي أكسب؟</button>
      </div>

      <div id="result" class="result"></div>
      <div class="status"><span class="badge">المحاولات المتبقية: <b id="triesLeft">0</b></span></div>
      <p style="text-align:center;color:#b8c3cc;margin:6px 0 0">💡 النتيجة بتظهر بعد ما العجلة توقف تمامًا.</p>
    </div>
  </div>

<script>
/* =================== تكوين العجلة عبر SVG =================== */
const segments = [
  {label:'0', color:'#0fbbe8'},
  {label:'1', color:'#f5b041'},
  {label:'2', color:'#8bd8ff'},
  {label:'حظ أوفر', color:'#ff5a7c'},
  {label:'3', color:'#27ae60'}
];
const rotor = document.getElementById('rotor');

const cx=50, cy=50, r=46, innerR=13; // نصف قطر الشريحة وفتحة الهب
const segAngle = 360/segments.length;

// ارسم الشرائح + النصوص
segments.forEach((seg, i)=>{
  const start = (i*segAngle-90) * Math.PI/180;   // نبدأ من أعلى الدائرة (−90°) عشان توزيع جميل
  const end   = ((i+1)*segAngle-90) * Math.PI/180;

  const x1 = cx + r*Math.cos(start), y1 = cy + r*Math.sin(start);
  const x2 = cx + r*Math.cos(end),   y2 = cy + r*Math.sin(end);

  const largeArc = segAngle > 180 ? 1 : 0;

  // مسار الشريحة (حلقة بين r و innerR)
  const xi1 = cx + innerR*Math.cos(end),
        yi1 = cy + innerR*Math.sin(end),
        xi2 = cx + innerR*Math.cos(start),
        yi2 = cy + innerR*Math.sin(start);

  const path = document.createElementNS('http://www.w3.org/2000/svg','path');
  const d = [
    `M ${xi1} ${yi1}`,
    `A ${innerR} ${innerR} 0 ${largeArc} 0 ${xi2} ${yi2}`,
    `L ${x1} ${y1}`,
    `A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2}`,
    'Z'
  ].join(' ');
  path.setAttribute('d', d);
  path.setAttribute('fill', seg.color);
  path.setAttribute('stroke', 'rgba(0,0,0,.25)');
  path.setAttribute('stroke-width','0.3');
  rotor.appendChild(path);

  // النص في منتصف الشريحة
  const midDeg = (i+0.5)*segAngle-90;
  const rad = midDeg*Math.PI/180;
  const tx = cx + (innerR + (r-innerR)*0.55)*Math.cos(rad);
  const ty = cy + (innerR + (r-innerR)*0.55)*Math.sin(rad);

  const text = document.createElementNS('http://www.w3.org/2000/svg','text');
  text.setAttribute('x', tx);
  text.setAttribute('y', ty);
  text.setAttribute('fill', '#fff');
  text.setAttribute('font-size', '8');
  text.setAttribute('font-weight', '800');
  text.setAttribute('text-anchor', 'middle');
  text.setAttribute('dominant-baseline', 'middle');
  text.textContent = seg.label;
  rotor.appendChild(text);
});

/* =================== منطق الدوران/الفوز =================== */
const PICK_DEG = 90; // السهم لتحت
const ATTEMPTS_PER_WEEK = 10;

let currentRotation = 0;
const spinBtn = document.getElementById('spinBtn');
const howBtn  = document.getElementById('howBtn');
const resultEl = document.getElementById('result');
const triesLeftEl = document.getElementById('triesLeft');

function isThursday(d=new Date()){ return d.getDay()===4; }
function getWeekKey(d=new Date()){
  const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum=(date.getUTCDay()+6)%7; date.setUTCDate(date.getUTCDate()-dayNum+3);
  const firstThursday=new Date(Date.UTC(date.getUTCFullYear(),0,4));
  const week=1+Math.round(((date-firstThursday)/86400000-3+(firstThursday.getUTCDay()+6)%7)/7);
  return `${date.getUTCFullYear()}-W${String(week).padStart(2,'0')}`;
}
function loadTries(){
  const key='wheel_svg_tries_'+getWeekKey();
  let left=Number(localStorage.getItem(key));
  if(!Number.isInteger(left)) left=ATTEMPTS_PER_WEEK;

  const openKey='wheel_svg_open_'+getWeekKey();
  if(isThursday() && localStorage.getItem(openKey)!=='1'){
    left=ATTEMPTS_PER_WEEK; localStorage.setItem(openKey,'1');
  }
  localStorage.setItem(key,String(left)); return left;
}
function saveTries(left){ localStorage.setItem('wheel_svg_tries_'+getWeekKey(), String(left)); }
function syncUI(){ const left=loadTries(); triesLeftEl.textContent=left; spinBtn.disabled=left<=0; }

function spin(){
  let left=loadTries(); if(left<=0){ resultEl.textContent='خلصت محاولاتك. جرّب الخميس الجاي ✨'; return; }
  spinBtn.disabled=true; resultEl.textContent='';

  const extra = 5 + Math.floor(Math.random()*4); // 5..8 دورات
  const randomAngle = Math.random()*360;
  currentRotation += extra*360 + randomAngle;
  rotor.style.transform = `rotate(${currentRotation}deg)`;

  setTimeout(()=>{
    const rot = currentRotation%360;
    const selected = (PICK_DEG - rot + 360) % 360;
    const index = Math.round(selected / segAngle) % segments.length;
    const outcome = segments[index].label;

    let msg=''; 
    if(outcome==='حظ أوفر') msg='حظ أوفر! جرّب تاني 🍀';
    else msg=`🎉 مبروك! كسبت ${Number(outcome)} توصيلة مجانية`;
    resultEl.textContent=msg;

    left=Math.max(0,left-1); saveTries(left); triesLeftEl.textContent=left;
    spinBtn.disabled=left<=0;
  },6100);
}

spinBtn.addEventListener('click',spin);
howBtn.addEventListener('click',()=>alert('• السهم لتحت هو المرجع.\n• 0/1/2/3 = عدد التوصيلات المجانية.\n• لو طلع "حظ أوفر" جرّب تاني.\n• المحاولات تتجدد تلقائيًا كل خميس.'));
syncUI();
</script>
</body>
</html>
